# 리액트 애플리케이션 도커라이즈하기

- 앞서 설명한 방법은 2~3단계의 과정만으로로 배포할 수 있다는 장점이 있지만, 애플리케이션을 자유롭게 커스터마이징하는 것에 제약이 있고, 비용 체계가 유연하지 못하다는 단점이 있음
- 이제는 도커(Docker)를 통해 애플리케이션을 하나의 컨테이너로 만들어서 빠르게 배포하는 것이 일반적임
- 이를 활용하면 특정 배포 서비스에 종속적이지 않은 상태로 만들어 좀 더 유연하게 관리할 수 있음

### 리액트 앱을 도커라이즈하는 방법

- **도커라이즈**: 애플리케이션을 도커 이미지로 만드는 과정 (애플리케이션을 신속하게 구축할 수 있는 상태로 준비하는 것)

#### ☑️ 도커란?

- **도커**: 개발자가 모던 애플리케이션을 구축, 공유, 실행하는 것을 도와줄 수 있도록 설계된 플랫폼. 도커는 지루한 설정 과정을 대신해 주므로 코드를 작성하는 일에만 집중할 수 있음
- `지루한 설정 작업`: 서버와 애플리케이션에 적절한 리소스를 확보, 운영체제 설치, Node.js 설치, 빌드 등
- 도커는 애플리케이션을 빠르게 배포할 수 있도록 애플리케이션을 '컨테이너'라는 단위로 패키징하고, 이 컨테이너를 바탕으로 독립된 환경에서 애플리케이션이 항상 일관되게 실행될 수 있게 보장해줌

#### 도커 용어

1. `이미지` : 도커에서 이미지란 컨테이너를 만드는 데 사용되는 템플릿을 의미
2. `컨테이너` :도커의 이미지를 실행한 상태
3. `Dockerfile` : 어떤 이미지 파일을 만들지 정의하는 파일
4. `태그` : 이미지를 식벼할 수 있는 레이블 값
5. `리포지터리` : 이미지를 모아두는 저장소로, 다양한 태그로 지정된 이미지들이 모여있음
6. `레지스토리` : 리포지터리에 접근할 수 있게 해주는 서비스 ex) 도커 허브

#### 자주 쓰는 도커 cli 명령어

1. `docker build` : Dockerfile을 기준으로 이미지를 빌드하는 작업
2. `docker push` : 이미지나 리포지터리를 도커 레지스토리에 업로드하는 과정
3. `docker tag` : 이미지에 태그를 생성하는 명령어
4. `docker inspect` : 이미지나 컨테이너의 세부 정보를 출력하는 명령어
5. `docker run` : 이미지를 기반으로 새로운 컨테이너를 생성하는 명령어
6. `docker ps` : 현재 가동 중인 컨테이너 목록을 확인할 수 있는 명령어
7. `docker rm` : 컨테이너를 삭제하는 명령어

<br/>

<div style="display: flex; align-items: start; justify-content: center; gap: 10px;">
  <img src="https://www.docker.com/app/uploads/2024/09/docker-desktop-hero.png" width=500 style="object-fit: contain">
</div>

<br/>

도커 데스크톱을 설치한 후 실행하면 다음과 같은 화면을 볼 수 있다. 대부분의 도커 관련 작업은 CLI를 통해 이뤄지기 때문에 도커를 심도 있게 공부하는 것도 필요하지만, 최소한의 노력으로 프론트엔드 애플리케이션을 배포하는 정도라면 도커 데스크톱에서 대부분 처리 가능하다.

#### ☑️ create-react-app을 위한 Dockerfile 작성하기

프론트엔드 애플리케이션이 도커 이미지에서 해야할 작업을 요약하자면 다음과 같다.

1. 운영체제 설정: 최소한의 운영체제 확보
2. Node.js 설치: npm 프로젝트 구동을 위해 필요
3. npm ci: 프로젝트 빌드에 필요한 의존성 모듈 설치
4. npm run build: 프로젝트 빌드
5. 실행: 프로젝트 실행

위에서 언급한 모든 과정을 Dockerfile에 기재하면 된다.

#### ☑️ create-next-app을 위한 Dockerfile 작성하기

Next.js로 만들어진 애플리케이션을 배포하는 과정도 크게 다르지 않으나, 한 가지 다른 점은 단순하게 빌드된 파일을 올리는 수준이 아니라 서버 실행이 필요하기 때문에 추가적인 설정을 Dockerfile에 작성하면 된다.

### 도커로 만든 이미지 배포하기

#### ☑️ 도커 이미지 업로드하기

- [도커 이미지 업로드](https://kicarussays.tistory.com/37)
- [GCP로 도커 이미지 배포](https://velog.io/@ththth663/Docker-%EC%9D%B4%EB%AF%B8%EC%A7%80-GCP%EC%97%90-%EB%B0%B0%ED%8F%AC%ED%95%98%EA%B8%B0)

#### 추가 자료

- [도커 사용법](https://zero-base.co.kr/event/media_insight_contents_BE_backend_docker)
